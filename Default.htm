<html>

<body>
    <script src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyDxWRvRCFu0yvYk_dbIM4v0c-6rETCsKPQ" type="text/javascript"></script>    <style>
        html {
            height: 100%
        }

        body {
            height: 100%;
            margin: 0px;
            padding: 0px
        }

        #map_canvas {
            height: 100%;
        }
    </style>
    <script>
        var directionDisplay;
        var directionsService = new google.maps.DirectionsService();
        var gmarkers = [];
        var map = null;
        var startLocation = null;
        var endLocation = null;
        var waypts = null;
        var infowindow = new google.maps.InfoWindow({
            size: new google.maps.Size(150, 50)
        });

        function createMarker(latlng, label, html, color) {
            var contentString = '<b>' + label + '</b><br>' + html;
            var marker = new google.maps.Marker({
                position: latlng,
                map: map,
                title: label,
                label: label,
                zIndex: Math.round(latlng.lat() * -100000) << 5
            });
            marker.myname = label;
            gmarkers.push(marker);
            google.maps.event.addListener(marker, 'click', function () {
                infowindow.setContent(contentString);
                infowindow.open(map, marker);
            });
            return marker;
        }
        function initialize() {
            directionsDisplay = new google.maps.DirectionsRenderer({
                suppressMarkers: true
            });
            var chicago = new google.maps.LatLng(37.327365, 40.756086);
            var myOptions = {
                zoom: 6,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                center: chicago
            }
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
            directionsDisplay.setMap(map);         
            calcRoute();
        }

        function calcRoute() {
            var request = {
                origin: "Mardin",
                destination: "Artuklu",
                waypoints: [{
                    location: new google.maps.LatLng(37.069536, 41.216133),
                    stopover: false
                },
                    {
                        location: new google.maps.LatLng(37.925995, 40.184393),
                        stopover: true
                    },
                     {
                         location: new google.maps.LatLng(37.879585, 41.164600),
                         stopover: true
                    }
                    ,
                    {
                        location: new google.maps.LatLng(37.327365, 40.756086),
                        stopover: true
                    }
                ],
                optimizeWaypoints: true,
                travelMode: google.maps.DirectionsTravelMode.DRIVING
            };
            directionsService.route(request, function (response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                    var route = response.routes[0];
                    var bounds = new google.maps.LatLngBounds();
                    var route = response.routes[0];
                    startLocation = new Object();
                    endLocation = new Object();
                    var polyline = new google.maps.Polyline({
                        path: [],
                        strokeColor: '#FF0000',
                        strokeWeight: 10
                    });


                    var legs = response.routes[0].legs;
                    for (i = 0; i < legs.length; i++) {                    
                        var steps = legs[i].steps;
                        for (j = 0; j < steps.length; j++) {
                            var nextSegment = steps[j].path;
                            for (k = 0; k < nextSegment.length; k++) {
                                polyline.getPath().push(nextSegment[k]);
                                bounds.extend(nextSegment[k]);
                            }
                        }
                    }
                    var waypoints = polyline.GetPointsAtDistance(50000);
                    for (var i = 0; i < waypoints.length; i++) {
                        createMarker(waypoints[i * 2], "" + (i * 2),"Deneme");
                    }
                } else {
                    alert("directions response " + status);
                }
            });
        }
        google.maps.event.addDomListener(window, 'load', initialize);      
        google.maps.Polyline.prototype.GetPointsAtDistance = function (metres) {
            var next = metres;
            var points = [];
            if (metres <= 0) return points;
            var dist = 0;
            var olddist = 0;
            for (var i = 1;
                (i < this.getPath().getLength()); i++) {
                olddist = dist;
                dist += google.maps.geometry.spherical.computeDistanceBetween(this.getPath().getAt(i), this.getPath().getAt(i - 1));
                while (dist > next) {
                    var p1 = this.getPath().getAt(i - 1);
                    var p2 = this.getPath().getAt(i);
                    var m = (next - olddist) / (dist - olddist);
                    points.push(new google.maps.LatLng(p1.lat() + (p2.lat() - p1.lat()) * m, p1.lng() + (p2.lng() - p1.lng()) * m));
                    next += metres;
                }
            }
            return points;
        }
    </script>
    <div id="map_canvas"></div>
</body>
</html>
